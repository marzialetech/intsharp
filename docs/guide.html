<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Running Simulations - intsharp</title>
    <link href="https://fonts.cdnfonts.com/css/w95fa" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="app">
        <!-- Sidebar -->
        <nav class="sidebar">
            <div class="sidebar-header">
                <h1>intsharp</h1>
                <span class="version">v1.0</span>
            </div>
            <div class="search-box">
                <input type="text" id="search" placeholder="Search..." autocomplete="off">
            </div>
            <ul class="nav-list" id="nav-list">
                <li><a href="index.html" data-page="home">Home</a></li>
                <li><a href="install.html" data-page="install">Installation</a></li>
                <li><a href="guide.html" class="active" data-page="guide">Running Simulations</a></li>
                <li><a href="components.html" data-page="components">Components</a></li>
                <li><a href="unit-tests.html" data-page="unit-tests">Unit Tests</a></li>
            </ul>
            <div class="sidebar-footer">
                <a href="https://github.com/marzialetech/intsharp" target="_blank">GitHub</a>
            </div>
        </nav>

        <!-- Main content -->
        <main class="content">
            <div class="window">
                <div class="window-header">
                    <span class="window-title">Running Simulations</span>
                </div>
                <div class="window-body">
                    <h2>Basic Usage</h2>
                    <pre><code>python run.py path/to/config.yaml</code></pre>
                    <p>When you run a simulation:</p>
                    <ol>
                        <li>A timestamped folder is created in the same directory as the YAML file</li>
                        <li>The YAML config is <strong>copied</strong> into this run folder (original remains for easy re-running)</li>
                        <li>All outputs (GIFs, images, data) are saved to the run folder</li>
                        <li>Initial conditions (step 0) are always output along with subsequent steps</li>
                    </ol>
                    <p>Example folder structure after a run:</p>
                    <pre><code>unit_tests/
└── my_config_YYYY-MM-DD_HH:MM:SS/
    ├── my_config.yaml   # copied config
    └── &lt;monitor outputs&gt;   # GIFs, images, etc.</code></pre>

                    <h2>YAML Configuration Reference</h2>

                    <h3>Domain (1D)</h3>
                    <p>1D domains are <strong>cell-centered</strong>: <code>dx = L/n_points</code>, with grid points at cell centers. This allows CFL = 1 to give exact return after one revolution (no phase drift).</p>
                    <pre><code>domain:
  x_min: -0.5      # Left boundary
  x_max: 0.5       # Right boundary
  n_points: 100    # Number of grid points (dx = L/n = 0.01)</code></pre>

                    <h3>Domain (2D)</h3>
                    <p>2D domains are <strong>cell-centered</strong>: <code>dx = Lx/n_points_x</code>, <code>dy = Ly/n_points_y</code>, with grid points at cell centers. This allows CFL = 1 in each direction to give exact return (no phase drift).</p>
                    <pre><code>domain:
  x_min: -0.5        # Left boundary
  x_max: 0.5         # Right boundary
  n_points_x: 100    # Grid points in x (dx = Lx/n_points_x)
  y_min: -0.5        # Bottom boundary
  y_max: 0.5         # Top boundary
  n_points_y: 100    # Grid points in y (dy = Ly/n_points_y)</code></pre>

                    <h3>Time</h3>
                    <pre><code>time:
  dt: 0.01         # Time step size
  n_steps: 200     # Number of steps</code></pre>

                    <h3>Velocity</h3>
                    <pre><code>velocity: [0.5]        # 1D: advection velocity (list with 1 element)
velocity: [0.5, 0.0]   # 2D: (u, v) advection velocity</code></pre>

                    <h3>Fields</h3>
                    <pre><code>fields:
  - name: alpha
    initial_condition: "0.5 * (tanh((0.1 + x) / 0.02) + tanh((0.1 - x) / 0.02))"
    boundary:
      type: periodic   # or neumann, dirichlet
    sharpening: true   # optional per-field override</code></pre>
                    <p><strong>Per-field sharpening:</strong> Each field can override the global sharpening setting by adding <code>sharpening: true</code> or <code>sharpening: false</code>. This allows comparing sharpened vs non-sharpened fields in the same simulation.</p>
                    <p>Initial conditions are Python expressions evaluated with:</p>
                    <ul>
                        <li><strong>1D:</strong> <code>x</code> (grid coordinates)</li>
                        <li><strong>2D:</strong> <code>x</code>, <code>y</code> (meshgrid), <code>r = sqrt(x² + y²)</code> (radial distance)</li>
                        <li>Math functions: <code>sin</code>, <code>cos</code>, <code>tanh</code>, <code>exp</code>, <code>sqrt</code>, <code>pi</code>, <code>np</code> (numpy)</li>
                    </ul>

                    <h4>Boundary Condition Types</h4>
                    <table>
                        <thead>
                            <tr>
                                <th>Type</th>
                                <th>Parameters</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><code>periodic</code></td>
                                <td>(none)</td>
                            </tr>
                            <tr>
                                <td><code>neumann</code></td>
                                <td><code>gradient_left</code>, <code>gradient_right</code></td>
                            </tr>
                            <tr>
                                <td><code>dirichlet</code></td>
                                <td><code>value_left</code>, <code>value_right</code></td>
                            </tr>
                        </tbody>
                    </table>

                    <h3>Solver</h3>
                    <pre><code>solver:
  type: upwind    # First-order upwind advection</code></pre>

                    <h3>Timestepper</h3>
                    <pre><code>timestepper:
  type: euler     # or rk4</code></pre>

                    <h3>Sharpening (Optional)</h3>
                    <pre><code>sharpening:
  enabled: true
  method: cl       # cl (Chiu-Lin) or pm (Parameswaran-Mandal)
  eps_target: 0.01 # Target interface thickness
  strength: 1.0    # Sharpening strength (Gamma)</code></pre>

                    <h3>Output Monitors</h3>
                    <p>When you use <code>run.py</code>, output is written to the timestamped run folder (the <code>output.directory</code> in the YAML is overridden). You can omit <code>output.directory</code> from your YAML.</p>
                    <pre><code>output:
  monitors:
    - type: console      # Progress bar (no file output)
    - type: gif
      every_n_steps: 20
      field: alpha
    - type: png
      every_n_steps: 50
      field: alpha
    - type: txt
      every_n_steps: 10
      field: alpha
    - type: curve
      every_n_steps: 10
      field: alpha
    - type: hdf5
      every_n_steps: 10
      fields: [alpha]
    # 2D-only monitors:
    - type: contour_gif
      every_n_steps: 20
      field: alpha
      contour_level: 0.5      # default 0.5
      show_centroid: true     # optional
      show_crosshairs: true   # optional
    - type: contour_compare_gif
      every_n_steps: 20
      compare_fields:
        - field: alpha_no_sharp
          contour_levels: [0.5]
          color: blue
          linestyle: "-"
        - field: alpha_pm
          contour_levels: [0.25, 0.5, 0.75]
          color: red
          linestyle: "--"</code></pre>

                    <h4>Monitor Types</h4>
                    <table>
                        <thead>
                            <tr>
                                <th>Type</th>
                                <th>Output</th>
                                <th>Parameters</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><code>console</code></td>
                                <td>Progress bar (tqdm)</td>
                                <td><code>every_n_steps</code></td>
                            </tr>
                            <tr>
                                <td><code>png</code></td>
                                <td>PNG images</td>
                                <td><code>field</code>, <code>every_n_steps</code> or <code>at_times</code></td>
                            </tr>
                            <tr>
                                <td><code>pdf</code></td>
                                <td>PDF images</td>
                                <td><code>field</code>, <code>every_n_steps</code> or <code>at_times</code></td>
                            </tr>
                            <tr>
                                <td><code>gif</code></td>
                                <td>Animated GIF</td>
                                <td><code>field</code>, <code>every_n_steps</code> or <code>at_times</code></td>
                            </tr>
                            <tr>
                                <td><code>hdf5</code></td>
                                <td>HDF5 file</td>
                                <td><code>fields</code> (list), <code>every_n_steps</code> or <code>at_times</code></td>
                            </tr>
                            <tr>
                                <td><code>txt</code></td>
                                <td>Columnar text</td>
                                <td><code>field</code>, <code>every_n_steps</code> or <code>at_times</code></td>
                            </tr>
                            <tr>
                                <td><code>curve</code></td>
                                <td>Curve format (x, y)</td>
                                <td><code>field</code>, <code>every_n_steps</code> or <code>at_times</code></td>
                            </tr>
                            <tr>
                                <td><code>contour_gif</code></td>
                                <td>Animated contour GIF (2D)</td>
                                <td><code>field</code>, <code>contour_level</code>, <code>show_centroid</code>, <code>show_crosshairs</code></td>
                            </tr>
                            <tr>
                                <td><code>contour_compare_gif</code></td>
                                <td>Compare multiple fields' contours (2D)</td>
                                <td><code>compare_fields</code> (list of field configs with <code>contour_levels</code>, <code>color</code>, <code>linestyle</code>)</td>
                            </tr>
                            <tr>
                                <td><code>compare_gif</code></td>
                                <td>Compare multiple 1D fields on one plot</td>
                                <td><code>compare_fields</code> (list with <code>field</code>, <code>color</code>, <code>linestyle</code>)</td>
                            </tr>
                        </tbody>
                    </table>

                </div>
            </div>
        </main>
    </div>

    <script src="search.js"></script>
</body>
</html>
